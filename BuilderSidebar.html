<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; padding: 12px; }
      label { display: block; margin-top: 10px; font-weight: bold; }
      input { width: 100%; padding: 6px; box-sizing: border-box; }
      button { margin-top: 14px; padding: 8px 12px; background: #111827; color: #fff; border: none; cursor: pointer; }
    </style>
  </head>
  <body>
    <h2>Backtesting Template Builder</h2>
    <form id="builderForm">
      <label for="startDate">Start date (YYYY-MM-DD)</label>
      <input type="date" id="startDate" name="startDate">

      <label for="numDays">Trading days to generate (max 365)</label>
      <input type="number" id="numDays" name="numDays" min="1" max="365" value="100">

      <label for="ticker">Ticker</label>
      <input type="text" id="ticker" name="ticker" value="MES">

      <button type="submit">Build Template</button>
    </form>
    <script>
      document.getElementById('builderForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = {
          startDate: document.getElementById('startDate').value,
          numDays: document.getElementById('numDays').value,
          ticker: document.getElementById('ticker').value
        };

        google.script.run
          .withSuccessHandler(() => google.script.host.close())
          .buildTemplateFromUI(formData);
      });
    </script>
  </body>
</html>
